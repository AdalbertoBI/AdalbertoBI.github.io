<!doctype html>
<html lang="pt-br">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>WhatIntegra - WhatsApp Web</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="./assets/styles.css" />
  </head>
  <body>
    <!-- Tela de Login -->
    <main id="loginScreen" class="login-container">
      <section class="login-card">
        <h1>ğŸš€ WhatIntegra</h1>
        <p class="login-subtitle">Acesse seu WhatsApp Web de qualquer lugar</p>

        <form id="loginForm">
          <label for="username">UsuÃ¡rio</label>
          <input id="username" name="username" autocomplete="username" required />

          <label for="password">Senha</label>
          <input id="password" name="password" type="password" autocomplete="current-password" required />

          <button type="submit" id="loginBtn">Entrar</button>
        </form>

        <div id="status" class="status" role="status" aria-live="polite"></div>

        <div id="configAlert" class="config-alert" style="display: none;">
          <div class="alert-content">
            <h3>âš ï¸ ConfiguraÃ§Ã£o NecessÃ¡ria</h3>
            <p>Para usar o WhatsApp Web, vocÃª precisa autorizar os servidores locais primeiro.</p>
            <a href="./setup.html" class="config-btn">ğŸ”§ Configurar Agora</a>
          </div>
        </div>

        <details class="help">
          <summary>Como funciona?</summary>
          <ul>
            <li>WhatsApp Web compartilhado atravÃ©s de servidor local</li>
            <li>SessÃ£o protegida na sua mÃ¡quina</li>
            <li>Acesso de qualquer dispositivo apÃ³s autenticaÃ§Ã£o</li>
          </ul>
        </details>
      </section>
    </main>

    <!-- Interface WhatsApp Web -->
    <main id="whatsappScreen" class="whatsapp-container hidden">
      <!-- Header -->
      <header class="whatsapp-header">
        <div class="header-left">
          <h1>ğŸš€ WhatIntegra</h1>
          <div class="connection-status" id="connectionStatus">
            <span class="status-dot"></span>
            <span id="statusText">Conectando...</span>
          </div>
        </div>
        <div class="header-right">
          <span id="displayUser" class="username"></span>
          <button id="logoutBtn" class="btn-icon" title="Sair">ğŸšª</button>
        </div>
      </header>

      <!-- QR Code Screen -->
      <div id="qrScreen" class="qr-screen">
        <div class="qr-container">
          <h2>ğŸ“± Conecte seu WhatsApp</h2>
          <p>Escaneie o cÃ³digo QR com seu celular</p>
          <div id="qrCode" class="qr-code"></div>
          <div class="qr-instructions">
            <ol>
              <li>Abra o WhatsApp no seu celular</li>
              <li>VÃ¡ em <strong>Menu > WhatsApp Web</strong></li>
              <li>Aponte a cÃ¢mera para este cÃ³digo</li>
            </ol>
          </div>
        </div>
      </div>

      <!-- Main WhatsApp Interface -->
      <div id="mainInterface" class="main-interface hidden">
        <!-- Sidebar com conversas -->
        <aside class="sidebar">
          <div class="sidebar-header">
            <h3>Conversas</h3>
            <div class="search-box">
              <input type="text" id="searchChats" placeholder="ğŸ” Buscar conversas..." />
            </div>
          </div>
          <div class="chats-list" id="chatsList">
            <div class="loading-chats">
              <div class="spinner"></div>
              <span>Carregando conversas...</span>
            </div>
          </div>
        </aside>

        <!-- Ãrea de chat -->
        <section class="chat-area">
          <div class="welcome-screen" id="welcomeScreen">
            <div class="welcome-content">
              <h2>ğŸ’¬ WhatIntegra</h2>
              <p>Selecione uma conversa para comeÃ§ar</p>
              <div class="feature-list">
                <div class="feature">âœ… WhatsApp Web sincronizado</div>
                <div class="feature">ğŸ”„ Tempo real para mÃºltiplos usuÃ¡rios</div>
                <div class="feature">ğŸ”’ Dados protegidos localmente</div>
              </div>
            </div>
          </div>

          <div class="chat-container hidden" id="chatContainer">
            <!-- Header do chat -->
            <div class="chat-header">
              <div class="contact-info">
                <div class="contact-avatar" id="chatAvatar">ğŸ‘¤</div>
                <div class="contact-details">
                  <h4 id="chatName">Selecione um chat</h4>
                  <span class="contact-status" id="chatStatus">online</span>
                </div>
              </div>
              <div class="chat-actions">
                <button class="btn-icon" title="Buscar mensagens">ğŸ”</button>
                <button class="btn-icon" title="Mais opÃ§Ãµes">â‹®</button>
              </div>
            </div>

            <!-- Mensagens -->
            <div class="messages-area" id="messagesArea">
              <div class="loading-messages">
                <div class="spinner"></div>
                <span>Carregando mensagens...</span>
              </div>
            </div>

            <!-- Input de mensagem -->
            <div class="message-input-area">
              <div class="message-input-container">
                <button class="btn-icon" title="Anexar">ğŸ“</button>
                <input 
                  type="text" 
                  id="messageInput" 
                  placeholder="Digite uma mensagem..." 
                  maxlength="1000"
                />
                <button id="sendBtn" class="btn-send" title="Enviar">ğŸ“¤</button>
              </div>
            </div>
          </div>
        </section>
      </div>
    </main>

    <!-- Scripts -->
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <script src="./assets/app.js"></script>
  </body>
</html>
